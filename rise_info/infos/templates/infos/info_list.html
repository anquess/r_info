{% extends "base.html" %}
{% load pygmentize %}
{% load custom_filters %}
{% block header %}
<style>
    {
        % pygments_css %
    }
</style>
{% endblock %}

{% block main %}

<div class="welcome">
    <h1>信頼性情報一覧</h1>
</div>
<form class="row g-3" method="get" action="" name="filter_form">
    <div class="col-auto">
        <label for="keyword" class="form-label">キーワード:</label>
    </div>
    <div class="col-auto">
        <input class="form-control" type="search" id="keyword" name="keyword" value={{ request.GET|keyword }}>
    </div>
    <div class="col-auto">
        <label for="info_type" class="form-label">情報種別:</label>
    </div>
    <div class="col-auto">
        <select class="form-select" type="search" id="info_type" name="info_type">
            <option value="">指定なし</option>
            {% for info_type in info_types %}
            {% if selelcted_info_type == info_type.0 %}
            <option value="{{ info_type.0 }}" selected>
                {% else %}
            <option value="{{ info_type.0 }}">
                {% endif %}
                {{ info_type.1 }}
            </option>
            {%endfor%}
        </select>
    </div>
    <div class="col-auto">
        <label for="eqtype" class="form-label">装置型式:</label>
    </div>
    <div class="col-auto">
        <input class="form-control" type="search" id="eqtype" name="eqtype" value={{ request.GET|eqtype }}>
    </div>
    <div class="col-auto">
        <button id="filter" type="submit" class="btn btn-secondary">検索</button>
    </div>
</form>
{% if auth %}
<a class="btn btn-primary float-end" href="{% url 'info_new' %}">＋</a>
{% endif %}
{% if infos %}
<table class="table">
    <thead>
        <tr>
            <th>情報種別</th>
            <th>タイトル</th>
            <th>概要</th>
            <th>投稿日</th>
            <th>更新日</th>
            <th>編集</th>
        </tr>
    </thead>
    <tbody>
        {% for info in infos %}
        <tr>
            <th>{{ info.get_info_type_display }}</th>
            <th><a href="{% url 'info_detail' info.id %}">{{ info.title }}</a></th>
            <th>{{ info.sammary | linebreaksbr}}</th>
            <th>{{ info.created_at | date:"y/n/j H:i" }}</th>
            <th>{{ info.updated_at | date:"y/n/j H:i" }}</th>
            {% if auth %}
            <th><a class="btn btn-primary" href="{% url 'info_edit' info.id %}">編集</a>
                <a class="btn btn-danger" href="{% url 'info_del' info.id %}"
                    onclick='return confirm("よろしいですか？");'>削除</a>
            </th>
            {% endif %}
        </tr>
        {% endfor %}
    </tbody>
</table>
{% else %}
<p>信頼性情報はまだ投稿されていません。</p>
{% endif %}
{% endblock %}